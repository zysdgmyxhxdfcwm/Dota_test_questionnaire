<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Dota2 Draft Survey</title>
<style>
  body { font-family: Arial, sans-serif; background:#1a1a1a; color:#fff; margin:20px; }
  h2 { text-align:center; margin-bottom:40px; }
  .question { margin-bottom:50px; padding:20px; background:#222; border-radius:8px; }
  .draft-section { display:flex; justify-content:space-between; margin:10px 0; }
  .team { width:48%; }
  .team h3 { text-align:center; margin-bottom:10px; }
  .heroes-row { display:flex; justify-content:center; flex-wrap:wrap; gap:10px; }
  .hero { width:64px; height:36px; }
  .hero img { width:100%; height:100%; border-radius:4px; border:2px solid transparent; }
  .pick-hero img { border-color: gold; box-shadow: 0 0 8px gold; }
  .options { margin-top:15px; display:flex; flex-direction:column; gap:5px; }
  button { margin-top:20px; padding:10px 20px; font-size:16px; border:none; border-radius:5px; cursor:pointer; }
</style>
</head>
<body>

<h2>给下面这个阵容打分</h2>
<div id="survey"></div>

<button id="submit">提交问卷</button>

<script>
async function loadSurvey() {
  const draftRes = await fetch('draft_results.json');
  const drafts = await draftRes.json(); // 假设是数组形式或对象形式
  const heroesRes = await fetch('heroes.json');
  const heroes = await heroesRes.json();

  const surveyContainer = document.getElementById('survey');

  // 把draft_results.json按对象形式转数组
  const draftArray = Array.isArray(drafts) ? drafts : Object.values(drafts);

  draftArray.forEach((draft, index) => {
    const questionDiv = document.createElement('div');
    questionDiv.className = 'question';
    questionDiv.dataset.draftId = draft.id;

    // 创建 Draft 区域
    function renderDraft(container, heroArray, isPick=false) {
      container.innerHTML = '';
      heroArray.forEach(heroItem => {
        let heroData;
        if(isPick){
          heroData = Object.values(heroes).find(h=>h.id===heroItem);
        }else{
          const key = heroItem.hero_name.toLowerCase().replace(/\s+/g,"_");
          heroData = heroes[key];
        }
        if(!heroData) return;
        const div = document.createElement('div');
        div.className = 'hero';
        if(isPick) div.classList.add('pick-hero');
        const img = document.createElement('img');
        img.src = heroData.image;
        img.title = heroData.name;
        div.appendChild(img);
        container.appendChild(div);
      });
    }

    // Pick 阶段
    const pickSection = document.createElement('div');
    pickSection.className = 'draft-section';
    const radiantPick = document.createElement('div'); radiantPick.className='team';
    radiantPick.innerHTML='<h3>Radiant Pick</h3><div class="heroes-row"></div>';
    const direPick = document.createElement('div'); direPick.className='team';
    direPick.innerHTML='<h3>Dire Pick</h3><div class="heroes-row"></div>';
    pickSection.appendChild(radiantPick);
    pickSection.appendChild(direPick);
    renderDraft(radiantPick.querySelector('.heroes-row'), draft.B.R, true);
    renderDraft(direPick.querySelector('.heroes-row'), draft.B.D, true);

    // Ban 阶段
    const banSection = document.createElement('div');
    banSection.className='draft-section';
    const radiantBan = document.createElement('div'); radiantBan.className='team';
    radiantBan.innerHTML='<h3>Radiant Ban</h3><div class="heroes-row"></div>';
    const direBan = document.createElement('div'); direBan.className='team';
    direBan.innerHTML='<h3>Dire Ban</h3><div class="heroes-row"></div>';
    banSection.appendChild(radiantBan);
    banSection.appendChild(direBan);
    renderDraft(radiantBan.querySelector('.heroes-row'), draft.R);
    renderDraft(direBan.querySelector('.heroes-row'), draft.D);

    questionDiv.appendChild(pickSection);
    questionDiv.appendChild(banSection);

    // 选项
    const optionsDiv = document.createElement('div');
    optionsDiv.className='options';
    const labels = [
      'A. Radiant一边倒',
      'B. Radiant略有优势',
      'C. 势均力敌',
      'D. Dire略有优势',
      'E. Dire一边倒'
    ];
    labels.forEach((label,i)=>{
      const id = `q${index}_option${i}`;
      const option = document.createElement('label');
      option.innerHTML = `<input type="radio" name="q${index}" value="${label}" id="${id}"> ${label}`;
      optionsDiv.appendChild(option);
    });
    questionDiv.appendChild(optionsDiv);

    surveyContainer.appendChild(questionDiv);
  });
}

loadSurvey();

// 收集结果
document.getElementById('submit').addEventListener('click',()=>{
  const surveyContainer = document.getElementById('survey');
  const questions = surveyContainer.querySelectorAll('.question');
  const results = {};
  questions.forEach(q=>{
    const draftId = q.dataset.draftId;
    const selected = q.querySelector('input[type=radio]:checked');
    results[draftId] = selected ? selected.value : null;
  });
  console.log('问卷结果:', results);
  alert('问卷结果已打印到控制台！');
  // 可以将 results JSON 上传到服务器或生成下载
});
</script>

</body>
</html>
