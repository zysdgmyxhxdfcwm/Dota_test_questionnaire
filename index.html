<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dota 2 Draft Viewer</title>

  <style>
    body {
      background-color: #1b1f24;
      color: #fff;
      font-family: "Segoe UI", sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }

    h1 {
      margin-bottom: 30px;
      font-size: 28px;
      letter-spacing: 1px;
      color: #f5f5f5;
    }

    .draft-container {
      display: flex;
      justify-content: space-between;
      width: 90%;
      max-width: 1200px;
      gap: 40px;
    }

    .team {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      background: #2a2f36;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 0 10px #0006;
    }

    .team h2 {
      margin-bottom: 15px;
      font-size: 22px;
    }

    .ban-phase, .pick-phase {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }

    .hero-slot {
      width: 80px;
      height: 45px;
      position: relative;
      border-radius: 6px;
      overflow: hidden;
      transition: transform 0.2s ease;
    }

    .hero-slot img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 6px;
    }

    .hero-slot:hover {
      transform: scale(1.08);
      z-index: 2;
    }

    .highlight {
      outline: 3px solid #ffcc00;
      box-shadow: 0 0 10px #ffcc00;
    }

    .tooltip {
      position: absolute;
      bottom: 110%;
      left: 50%;
      transform: translateX(-50%);
      background-color: rgba(0, 0, 0, 0.8);
      color: #fff;
      padding: 5px 8px;
      border-radius: 4px;
      font-size: 13px;
      white-space: nowrap;
      display: none;
    }

    .hero-slot:hover .tooltip {
      display: block;
    }

    .section-label {
      font-size: 16px;
      margin-bottom: 10px;
      text-transform: uppercase;
      color: #ccc;
    }

    .radiant h2 { color: #9be39b; }
    .dire h2 { color: #e06060; }

  </style>
</head>

<body>
  <h1>Dota 2 Draft Visualization</h1>
  <div class="draft-container">
    <div class="team radiant">
      <h2>Radiant</h2>

            <div class="section-label">Picks</div>
      <div class="pick-phase" id="radiant-picks"></div>
            <div class="section-label">Bans</div>
      <div class="ban-phase" id="radiant-bans"></div>

    </div>

    <div class="team dire">
      <h2>Dire</h2>

            <div class="section-label">Picks</div>
      <div class="pick-phase" id="dire-picks"></div>
            <div class="section-label">Bans</div>
      <div class="ban-phase" id="dire-bans"></div>

    </div>
  </div>

  <script>
    async function loadData() {
      const [draftRes, heroesRes] = await Promise.all([
        fetch('./draft_results.json'),
        fetch('./heroes.json')
      ]);
      const draftData = await draftRes.json();
      const heroes = await heroesRes.json();

      // 取第一个 draft 示例（如有多个可扩展）
      const draft = Array.isArray(draftData) ? draftData[0] : draftData;

      renderDraft(draft, heroes);
    }

    function renderDraft(draft, heroes) {
      const radiantBans = document.getElementById("radiant-bans");
      const direBans = document.getElementById("dire-bans");
      const radiantPicks = document.getElementById("radiant-picks");
      const direPicks = document.getElementById("dire-picks");

      radiantBans.innerHTML = '';
      direBans.innerHTML = '';
      radiantPicks.innerHTML = '';
      direPicks.innerHTML = '';

      // 渲染 Ban 阶段
      draft.R.forEach(ban => {
        const slot = createHeroSlot(ban, heroes);
        radiantBans.appendChild(slot);
      });
      draft.D.forEach(ban => {
        const slot = createHeroSlot(ban, heroes);
        direBans.appendChild(slot);
      });

      // 渲染 Pick 阶段
      draft.B.R.forEach(hero_id => {
        const hero = findHeroById(hero_id, heroes);
        const slot = createHeroSlot(hero, heroes);
        radiantPicks.appendChild(slot);
      });
      draft.B.D.forEach(hero_id => {
        const hero = findHeroById(hero_id, heroes);
        const slot = createHeroSlot(hero, heroes);
        direPicks.appendChild(slot);
      });
    }

    function findHeroById(id, heroes) {
      for (const key in heroes) {
        if (heroes[key].id === id) return heroes[key];
      }
      return { name: "Unknown", image: "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/heroes/default_full.png" };
    }

    function createHeroSlot(hero, heroes) {
      const slot = document.createElement("div");
      slot.classList.add("hero-slot");

      // 判断是否模型补出
      if (hero.source === "model") {
        slot.classList.add("highlight");
      }

      // 获取图片
      let imageUrl;
      if (hero.image) {
        imageUrl = hero.image;
      } else {
        const key = hero.hero_name
          ? hero.hero_name.toLowerCase().replace(/\s+/g, "_")
          : hero.name.toLowerCase().replace(/\s+/g, "_");
        imageUrl = heroes[key]?.image || "https://cdn.cloudflare.steamstatic.com/apps/dota2/images/heroes/default_full.png";
      }

      const img = document.createElement("img");
      img.src = imageUrl;
      img.alt = hero.hero_name || hero.name || "Unknown";

      const tooltip = document.createElement("div");
      tooltip.classList.add("tooltip");
      tooltip.textContent = hero.hero_name || hero.name || "Unknown";

      slot.appendChild(img);
      slot.appendChild(tooltip);

      return slot;
  S }

    loadData();
  </script>
</body>
</html>
